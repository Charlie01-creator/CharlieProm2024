<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Lightweight image gallery">
    <style>
        /* Minimal CSS inlined - no external resources */
        *{margin:0;padding:0;box-sizing:border-box}body{background:#f5f5f5;padding:5px;user-select:none}.gallery{display:flex;gap:5px}.gallery-column{flex:1;display:flex;flex-direction:column;gap:5px}.gallery-item{width:100%;background:#fff;border-radius:4px;overflow:hidden;box-shadow:0 1px 2px rgba(0,0,0,0.05);position:relative;aspect-ratio:3/4}.gallery-item img{width:100%;height:100%;display:block;object-fit:cover;background:#e0e0e0}.watermark{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:2;opacity:0.1;background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Ctext x='50%25' y='50%25' fill='black' font-size='10' text-anchor='middle' dominant-baseline='middle' transform='rotate(-30 50 50)'%3EAG%3C/text%3E%3C/svg%3E")}.img-placeholder{width:100%;height:100%;background:#e0e0e0}
    </style>
</head>
<body>
    <div class="gallery">
        <div class="gallery-column" id="col1"></div>
        <div class="gallery-column" id="col2"></div>
        <div class="gallery-column" id="col3"></div>
    </div>

    <script>
        // Minimal JavaScript with aggressive optimizations
        (function() {
            // Configuration - adjust based on your needs
            const config = {
                imageQuality: navigator.connection?.effectiveType.includes('2g') ? 'low' : 'medium',
                loadThreshold: 300, // pixels from viewport to start loading
                maxColumns: window.innerWidth < 600 ? 2 : 3
            };
            
            // Image data - format: [filename, width, height, placeholder color]
            const images = [
                ['1.jpg', 800, 600, 'e0d0c0'],
                ['2.jpg', 800, 600, 'd0e0c0'],
                // Add all your images here in the same format
            ];
            
            // DOM elements
            const columns = [
                document.getElementById('col1'),
                document.getElementById('col2'),
                document.getElementById('col3')
            ].slice(0, config.maxColumns);
            
            // Generate gallery items
            function createGalleryItem(imgData, index) {
                const [filename, width, height, color] = imgData;
                const col = index % columns.length;
                const quality = config.imageQuality === 'low' ? 'low-' : '';
                
                const item = document.createElement('div');
                item.className = 'gallery-item';
                item.innerHTML = `
                    <div class="watermark"></div>
                    <div class="img-placeholder" style="background:#${color}"></div>
                    <img 
                        data-src="${quality}${filename}" 
                        alt="Image ${index+1}"
                        loading="lazy"
                        decoding="async"
                        width="${width}"
                        height="${height}"
                    >
                `;
                columns[col].appendChild(item);
                return item.querySelector('img');
            }
            
            // Super lightweight lazy loading
            function initLazyLoad() {
                const io = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            img.src = img.dataset.src;
                            img.onload = () => {
                                img.previousElementSibling.style.display = 'none';
                                img.removeAttribute('data-src');
                            };
                            io.unobserve(img);
                        }
                    });
                }, { threshold: 0.01, rootMargin: `${config.loadThreshold}px` });
                
                document.querySelectorAll('img[data-src]').forEach(img => io.observe(img));
            }
            
            // Generate the gallery
            images.forEach((img, i) => createGalleryItem(img, i));
            initLazyLoad();
            
            // Basic protection
            document.addEventListener('contextmenu', e => e.preventDefault());
        })();
    </script>
</body>
</html>
